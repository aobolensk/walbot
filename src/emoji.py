from typing import Optional

from src import const

alphabet = "ðŸ‡¦ðŸ‡§ðŸ‡¨ðŸ‡©ðŸ‡ªðŸ‡«ðŸ‡¬ðŸ‡­ðŸ‡®ðŸ‡¯ðŸ‡°ðŸ‡±ðŸ‡²ðŸ‡³ðŸ‡´ðŸ‡µðŸ‡¶ðŸ‡·ðŸ‡¸ðŸ‡¹ðŸ‡ºðŸ‡»ðŸ‡¼ðŸ‡½ðŸ‡¾ðŸ‡¿"

text_to_emoji = {
    'a': 'ðŸ‡¦',
    'b': 'ðŸ‡§',
    'c': 'ðŸ‡¨',
    'd': 'ðŸ‡©',
    'e': 'ðŸ‡ª',
    'f': 'ðŸ‡«',
    'g': 'ðŸ‡¬',
    'h': 'ðŸ‡­',
    'i': 'ðŸ‡®',
    'j': 'ðŸ‡¯',
    'k': 'ðŸ‡°',
    'l': 'ðŸ‡±',
    'm': 'ðŸ‡²',
    'n': 'ðŸ‡³',
    'o': 'ðŸ‡´',
    'p': 'ðŸ‡µ',
    'q': 'ðŸ‡¶',
    'r': 'ðŸ‡·',
    's': 'ðŸ‡¸',
    't': 'ðŸ‡¹',
    'u': 'ðŸ‡º',
    'v': 'ðŸ‡»',
    'w': 'ðŸ‡¼',
    'x': 'ðŸ‡½',
    'y': 'ðŸ‡¾',
    'z': 'ðŸ‡¿',
    '0': '0ï¸âƒ£',
    '1': '1ï¸âƒ£',
    '2': '2ï¸âƒ£',
    '3': '3ï¸âƒ£',
    '4': '4ï¸âƒ£',
    '5': '5ï¸âƒ£',
    '6': '6ï¸âƒ£',
    '7': '7ï¸âƒ£',
    '8': '8ï¸âƒ£',
    '9': '9ï¸âƒ£',
    '#': '#ï¸âƒ£',
    '*': '*ï¸âƒ£',
    '!': 'â—',
    '?': 'â“',
    'Ð°': 'ðŸ‡¦',
    'Ð±': 'ðŸ‡§',
    'Ð²': 'ðŸ‡»',
    'Ð³': 'ðŸ‡¬',
    'Ð´': 'ðŸ‡©',
    'Ðµ': 'ðŸ‡ª',
    'Ñ‘': 'ðŸ‡ª',
    'Ð¶': 'ðŸ‡¿ ðŸ‡­',
    'Ð·': 'ðŸ‡¿',
    'Ð¸': 'ðŸ‡®',
    'Ð¹': 'ðŸ‡®',
    'Ðº': 'ðŸ‡°',
    'Ð»': 'ðŸ‡±',
    'Ð¼': 'ðŸ‡²',
    'Ð½': 'ðŸ‡³',
    'Ð¾': 'ðŸ‡´',
    'Ð¿': 'ðŸ‡µ',
    'Ñ€': 'ðŸ‡·',
    'Ñ': 'ðŸ‡¸',
    'Ñ‚': 'ðŸ‡¹',
    'Ñƒ': 'ðŸ‡º',
    'Ñ„': 'ðŸ‡«',
    'Ñ…': 'ðŸ‡° ðŸ‡­',
    'Ñ†': 'ðŸ‡¹ ðŸ‡¸',
    'Ñ‡': 'ðŸ‡¨ ðŸ‡­',
    'Ñˆ': 'ðŸ‡¸ ðŸ‡­',
    'Ñ‰': 'ðŸ‡¸ ðŸ‡­ ðŸ‡¨ ðŸ‡­',
    'ÑŠ': '',
    'Ñ‹': 'ðŸ‡¾',
    'ÑŒ': '',
    'Ñ': 'ðŸ‡ª',
    'ÑŽ': 'ðŸ‡® ðŸ‡º',
    'Ñ': 'ðŸ‡® ðŸ‡¦',
}

emoji_to_text = {
    'ðŸ‡¦': 'a',
    'ðŸ‡§': 'b',
    'ðŸ‡¨': 'c',
    'ðŸ‡©': 'd',
    'ðŸ‡ª': 'e',
    'ðŸ‡«': 'f',
    'ðŸ‡¬': 'g',
    'ðŸ‡­': 'h',
    'ðŸ‡®': 'i',
    'ðŸ‡¯': 'j',
    'ðŸ‡°': 'k',
    'ðŸ‡±': 'l',
    'ðŸ‡²': 'm',
    'ðŸ‡³': 'n',
    'ðŸ‡´': 'o',
    'ðŸ‡µ': 'p',
    'ðŸ‡¶': 'q',
    'ðŸ‡·': 'r',
    'ðŸ‡¸': 's',
    'ðŸ‡¹': 't',
    'ðŸ‡º': 'u',
    'ðŸ‡»': 'v',
    'ðŸ‡¼': 'w',
    'ðŸ‡½': 'x',
    'ðŸ‡¾': 'y',
    'ðŸ‡¿': 'z',
    '0ï¸âƒ£': '0',
    '1ï¸âƒ£': '1',
    '2ï¸âƒ£': '2',
    '3ï¸âƒ£': '3',
    '4ï¸âƒ£': '4',
    '5ï¸âƒ£': '5',
    '6ï¸âƒ£': '6',
    '7ï¸âƒ£': '7',
    '8ï¸âƒ£': '8',
    '9ï¸âƒ£': '9',
    '#ï¸âƒ£': '#',
    '*ï¸âƒ£': '*',
    'â—': '!',
    'â“': '?',
}


_clock_emoji_mapping = {
    (12, 0): "ðŸ•›",
    (12, 30): "ðŸ•§",
    (1, 0): "ðŸ•",
    (1, 30): "ðŸ•œ",
    (2, 0): "ðŸ•‘",
    (2, 30): "ðŸ•",
    (3, 0): "ðŸ•’",
    (3, 30): "ðŸ•ž",
    (4, 0): "ðŸ•“",
    (4, 30): "ðŸ•Ÿ",
    (5, 0): "ðŸ•”",
    (5, 30): "ðŸ• ",
    (6, 0): "ðŸ••",
    (6, 30): "ðŸ•¡",
    (7, 0): "ðŸ•–",
    (7, 30): "ðŸ•¢",
    (8, 0): "ðŸ•—",
    (8, 30): "ðŸ•£",
    (9, 0): "ðŸ•˜",
    (9, 30): "ðŸ•¤",
    (10, 0): "ðŸ•™",
    (10, 30): "ðŸ•¥",
    (11, 0): "ðŸ•š",
    (11, 30): "ðŸ•¦",
}


def get_clock_emoji(time: str) -> Optional[str]:
    r = const.TIME_24H_REGEX.match(time)
    if r is None:
        return
    hours, minutes = (int(x) for x in r.groups())
    if minutes < 15:
        minutes = 0
    elif 15 <= minutes < 45:
        minutes = 30
    else:  # 45 <= minutes < 60
        minutes = 0
        hours += 1
    while hours > 12:
        hours -= 12
    while hours <= 0:
        hours += 12
    assert (hours, minutes) in _clock_emoji_mapping.keys()
    return _clock_emoji_mapping[(hours, minutes)]
